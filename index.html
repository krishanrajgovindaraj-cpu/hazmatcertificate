<!DOCTYPE html>
<html>
<head>
  <title>OZELLAR MARINE - ESE Certificate Generator</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    body {
      font-family: Calibri, sans-serif;
      margin: 30px;
      background: #ffffff;
    }

    .form-container {
      border: 2px solid #000;
      padding: 20px;
      width: 420px;
      border-radius: 10px;
      background-color: white;
      margin-bottom: 40px;
    }

    label { display:block; margin-top:12px; }
    input { width:100%; padding:6px; margin-top:4px; }

    button {
      margin-top: 10px;
      padding: 6px 12px;
      background-color: #347c05;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    /* ===== A4 CERTIFICATE ===== */
    #certificate {
      width: 210mm;
      min-height: 297mm;
      padding: 20mm;
      box-sizing: border-box;
      background: white;
      margin: auto;
      position: relative;
      display: none;
      border: 1px solid black;
    }

    #companyLogo {
      position: absolute;
      top: 20mm;
      right: 20mm;
      width: 35mm;
      display: none;
    }

    #candidatePhoto {
      position: absolute;
      bottom: 25mm;
      left: 20mm;
      width: 30mm;
      height: 40mm;
      object-fit: cover;
      border: 1px solid #000;
      display: none;
    }

    #signatureImage {
      position: absolute;
      bottom: 35mm;
      right: 30mm;
      width: 35mm;
      display: none;
    }

    .underline {
      border-bottom: 1px solid #000;
      padding: 0 5px;
      min-width: 120px;
      display: inline-block;
    }
  </style>
</head>

<body>

<h1 style="color:#ED7C31;">ENCLOSED SPACE ENTRY TRAINING</h1>

<div class="form-container">

  <label>Certificate No</label>
  <input id="certNo">

  <label>Candidate Name</label>
  <input id="name">

  <label>PP No</label>
  <input id="ppNo">

  <label>Conducted Date</label>
  <input id="conductedDate">

  <label>Conducted At</label>
  <input id="conductedAt">

  <label>Issue Date</label>
  <input id="issueDate">

  <label>Upload Company Logo</label>
  <input type="file" id="logoUpload">

  <label>Upload Course Incharge Signature</label>
  <input type="file" id="signatureUpload">

  <label>Upload Passport Size Photo</label>
  <input type="file" id="photoUpload">

  <button type="button" onclick="generateCertificate()">Generate Certificate</button>
  <button type="button" id="downloadBtn" style="display:none;" onclick="downloadPDF()">Download PDF</button>

</div>

<!-- ===== CERTIFICATE ===== -->

<div id="certificate">

  <img id="companyLogo">
  <img id="candidatePhoto">

  <div style="text-align:center;">
    <h2 style="color:#ED7C31;">OZELLAR MARINE PRIVATE LIMITED</h2>
    <p>
      Aneja Towers, B Block 4th Floor<br>
      Plot 4 & 5, Developed Plot Estate<br>
      Perungudi, Chennai â€“ 600096
    </p>
  </div>

  <h3 style="text-align:right;">
    Certificate No: <span class="underline" id="outCertNo"></span>
  </h3>

  <p>This is to certify that <span class="underline" id="outName"></span></p>
  <p>PP No <span class="underline" id="outPPNo"></span></p>

  <h2 style="text-align:center;">ENCLOSED SPACE ENTRY TRAINING</h2>

  <p style="text-align:center;">
    Conducted on <span class="underline" id="outConductedDate"></span>
    at <span class="underline" id="outConductedAt"></span>
  </p>

  <h3>This course covered the following topics:</h3>

  <ul style="font-size:16px; line-height:2;">
    <li>Regulatory Requirement IMO Resolution A.1050(27), COWSP Chapter 15</li>
    <li>Hazard related to enclosed spaces</li>
    <li>Enclosed space entry procedure</li>
    <li>Equipment and procedures required for enclosed space entry</li>
    <li>Enclosed space entry procedure as per Company Manuals</li>
    <li>Emergency response procedure</li>
  </ul>

  <div style="position:absolute; bottom:35mm; right:30mm;">
    _______________________<br>Course Incharge Signature
  </div>

  <p style="position:absolute; bottom:20mm; left:20mm;">
    Date of Issue: <span class="underline" id="outIssueDate"></span>
  </p>

  <img id="signatureImage">

</div>

<script>

function generateCertificate() {

  const certNoVal = document.getElementById("certNo").value.trim();
  const nameVal = document.getElementById("name").value.trim();
  const ppNoVal = document.getElementById("ppNo").value.trim();
  const conductedDateVal = document.getElementById("conductedDate").value.trim();
  const conductedAtVal = document.getElementById("conductedAt").value.trim();
  const issueDateVal = document.getElementById("issueDate").value.trim();

  if (certNoVal === "" || nameVal === "" || ppNoVal === "" || conductedDateVal === "" || conductedAtVal === "") {
    alert("Please fill all required fields.");
    return;
  }

  document.getElementById("outCertNo").textContent = certNoVal;
  document.getElementById("outName").textContent = nameVal;
  document.getElementById("outPPNo").textContent = ppNoVal;
  document.getElementById("outConductedDate").textContent = conductedDateVal;
  document.getElementById("outConductedAt").textContent = conductedAtVal;
  document.getElementById("outIssueDate").textContent =
      issueDateVal || new Date().toLocaleDateString("en-GB");

  document.getElementById("certificate").style.display = "block";
  document.getElementById("downloadBtn").style.display = "inline-block";
}

function downloadPDF() {

  const element = document.getElementById("certificate");

  const opt = {
    margin: 0,
    filename: 'Certificate.pdf',
    image: { type: 'jpeg', quality: 1 },
    html2canvas: { scale: 3, useCORS: true },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().set(opt).from(element).save();
}

/* IMAGE UPLOADS */

document.getElementById("logoUpload").onchange = function(e) {
  const reader = new FileReader();
  reader.onload = () => {
    const logo = document.getElementById("companyLogo");
    logo.src = reader.result;
    logo.style.display = "block";
  };
  reader.readAsDataURL(e.target.files[0]);
};

document.getElementById("signatureUpload").onchange = function(e) {
  const reader = new FileReader();
  reader.onload = () => {
    const sign = document.getElementById("signatureImage");
    sign.src = reader.result;
    sign.style.display = "block";
  };
  reader.readAsDataURL(e.target.files[0]);
};

document.getElementById("photoUpload").onchange = function(e) {
  const reader = new FileReader();
  reader.onload = () => {
    const photo = document.getElementById("candidatePhoto");
    photo.src = reader.result;
    photo.style.display = "block";
  };
  reader.readAsDataURL(e.target.files[0]);
};

</script>

</body>
</html>